<div class="sidebar-transacciones">
  <p class="side-list-title">MI PERFIL</p>
  <a href="/perfil">
    <button class="side-list">PERFIL</button>
  </a>
  <a href="/transacciones">
    <button class="side-list">HISTORIAL DE TRANSFERENCIAS</button>
  </a>
  <a href="/historial-apuestas">
    <button class="side-list">HISTORIAL DE APUESTAS</button>
  </a>
  <a href="/deposito">
    <button class="side-list">TRANSACCIONES</button>
  </a>
  {{#if isLoggedIn}}
  <form action="/logout" method="post" style="margin-top: auto;">
    <button class="side-list logout-button" type="submit">CERRAR SESIÓN</button>
  </form>
  {{/if}}
</div>

<div class="transacciones-container">
  <form class="busqueda-trans" method="get" action="/historial-apuestas">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Mostrar:</label>
      <select name="limit" class="texto-trans">
        <option value="10" {{#if (eq limit 10)}}selected{{/if}}>10</option>
        <option value="25" {{#if (eq limit 25)}}selected{{/if}}>25</option>
        <option value="50" {{#if (eq limit 50)}}selected{{/if}}>50</option>
        <option value="100" {{#if (eq limit 100)}}selected{{/if}}>100</option>
      </select>
    </div>

    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Estado:</label>
      <select name="estado" class="texto-trans">
        <option value="">Todos</option>
        <option value="Ganada" {{#if (eq estado 'Ganada')}}selected{{/if}}>Ganada</option>
        <option value="Perdida" {{#if (eq estado 'Perdida')}}selected{{/if}}>Perdida</option>
      </select>
    </div>

    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Tipo:</label>
      <select name="tipoApuesta" class="texto-trans">
        <option value="">Todos</option>
        <option value="pleno" {{#if (eq tipoApuesta 'pleno')}}selected{{/if}}>Pleno</option>
        <option value="caballo" {{#if (eq tipoApuesta 'caballo')}}selected{{/if}}>Caballo</option>
        <option value="transversal" {{#if (eq tipoApuesta 'transversal')}}selected{{/if}}>Transversal</option>
        <option value="cuadro" {{#if (eq tipoApuesta 'cuadro')}}selected{{/if}}>Cuadro</option>
        <option value="seisena" {{#if (eq tipoApuesta 'seisena')}}selected{{/if}}>Seisena</option>
        <option value="docena" {{#if (eq tipoApuesta 'docena')}}selected{{/if}}>Docena</option>
        <option value="columna" {{#if (eq tipoApuesta 'columna')}}selected{{/if}}>Columna</option>
        <option value="dos-docenas" {{#if (eq tipoApuesta 'dos-docenas')}}selected{{/if}}>Dos Docenas</option>
        <option value="dos-columnas" {{#if (eq tipoApuesta 'dos-columnas')}}selected{{/if}}>Dos Columnas</option>
        <option value="rojo" {{#if (eq tipoApuesta 'rojo')}}selected{{/if}}>Rojo</option>
        <option value="negro" {{#if (eq tipoApuesta 'negro')}}selected{{/if}}>Negro</option>
        <option value="par" {{#if (eq tipoApuesta 'par')}}selected{{/if}}>Par</option>
        <option value="impar" {{#if (eq tipoApuesta 'impar')}}selected{{/if}}>Impar</option>
        <option value="falta" {{#if (eq tipoApuesta 'falta')}}selected{{/if}}>Falta (1-18)</option>
        <option value="pasa" {{#if (eq tipoApuesta 'pasa')}}selected{{/if}}>Pasa (19-36)</option>
      </select>
    </div>

    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Desde:</label>
      <input type="date" name="dateFrom" class="texto-trans" value="{{dateFrom}}" />
    </div>
    
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Hasta:</label>
      <input type="date" name="dateTo" class="texto-trans" value="{{dateTo}}" />
    </div>
    
    <button class="buscar" type="submit">Filtrar</button>
    <a href="/historial-apuestas"><button class="buscar" type="button">Limpiar</button></a>
  </form>

  <div class="tabla-trans">
    <h1 class="titulo-transferencia">Historial de Apuestas</h1>

    <table class="contenido">
      <thead>
        <tr>
          <th>N°</th>
          <th>Código</th>
          <th>Fecha</th>
          <th>Tipo de Apuesta</th>
          <th>Valor Apostado</th>
          <th>Monto</th>
          <th>Número Ganador</th>
          <th>Estado</th>
          <th>Pago</th>
        </tr>
      </thead>
      <tbody>
        {{#each apuestas}}
        <tr>
          <td>{{add @index 1}}.-</td>
          <td>{{shortId _id}}</td>
          <td>{{formatDate createdAt}}</td>
          <td>{{formatTipoApuesta tipoApuesta}}</td>
          <td>{{formatValorApostado valorApostado tipoApuesta}}</td>
          <td>${{monto}}</td>
          <td>{{numeroGanador}}</td>
          <td>
            <span style="color: {{#if (eq estado 'Ganada')}}#4ade80{{else}}#ef4444{{/if}}; font-weight: 600;">
              {{estado}}
            </span>
          </td>
          <td>
            <span style="color: {{#if (eq estado 'Ganada')}}#4ade80{{else}}#ef4444{{/if}}; font-weight: 600;">
              {{#if (eq estado 'Ganada')}}+{{/if}}${{pago}}
            </span>
          </td>
        </tr>
        {{else}}
        <tr>
          <td colspan="9" style="text-align: center;">No hay apuestas disponibles</td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</div>
