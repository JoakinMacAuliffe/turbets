<div class="sidebar-transacciones">
  <p class="side-list-title">MI PERFIL</p>
  <a href="/perfil">
    <button class="side-list">PERFIL</button>
  </a>
  <a href="/transacciones">
    <button class="side-list">HISTORIAL DE TRANSFERENCIAS</button>
  </a>
  <a href="/historial-apuestas">
    <button class="side-list">HISTORIAL DE APUESTAS</button>
  </a>
  <a href="/deposito">
    <button class="side-list">TRANSACCIONES</button>
  </a>
  {{#if isLoggedIn}}
  <form action="/logout" method="post" style="margin-top: auto;">
    <button class="side-list logout-button" type="submit">CERRAR SESIÓN</button>
  </form>
  {{/if}}
</div>

<div class="transacciones-container">
  <form class="busqueda-trans" method="get" action="/transacciones">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Mostrar:</label>
      <select name="limit" class="texto-trans">
        <option value="10" {{#if (eq limit 10)}}selected{{/if}}>10</option>
        <option value="25" {{#if (eq limit 25)}}selected{{/if}}>25</option>
        <option value="50" {{#if (eq limit 50)}}selected{{/if}}>50</option>
        <option value="100" {{#if (eq limit 100)}}selected{{/if}}>100</option>
      </select>
    </div>

    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Tipo:</label>
      <select name="type" class="texto-trans">
        <option value="">Todos</option>
        <option value="DEPOSITO" {{#if (eq type 'DEPOSITO')}}selected{{/if}}>Depósito</option>
        <option value="RETIRO" {{#if (eq type 'RETIRO')}}selected{{/if}}>Retiro</option>
        <option value="VICTORIA" {{#if (eq type 'VICTORIA')}}selected{{/if}}>Victoria</option>
        <option value="DERROTA" {{#if (eq type 'DERROTA')}}selected{{/if}}>Derrota</option>
      </select>
    </div>

    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Desde:</label>
      <input type="date" name="dateFrom" class="texto-trans" value="{{dateFrom}}" />
    </div>
    
    <div style="display: flex; align-items: center; gap: 0.5rem;">
      <label class="nombre-texto">Hasta:</label>
      <input type="date" name="dateTo" class="texto-trans" value="{{dateTo}}" />
    </div>
    
    <button class="buscar" type="submit">Filtrar</button>
    <a href="/transacciones"><button class="buscar" type="button">Limpiar</button></a>
  </form>

  <div class="tabla-trans">
    <h1 class="titulo-transferencia">Historial de Transacciones</h1>

    <table class="contenido">
      <thead>
        <tr>
          <th>N°</th>
          <th>Código</th>
          <th>Fecha</th>
          <th>Tipo</th>
          <th>Saldo anterior</th>
          <th>Saldo actual</th>
          <th>Monto</th>
        </tr>
      </thead>
      <tbody>
        {{#each transactions}}
        <tr>
          <td>{{@index}}.-</td>
          <td>{{shortId _id}}</td>
          <td>{{formatDate createdAt}}</td>
          <td>{{type}}</td>
          <td>${{prebalance}}</td>
          <td>${{postbalance}}</td>
          <td>${{amount}}</td>
        </tr>
        {{else}}
        <tr>
          <td colspan="7" style="text-align: center;">No hay transacciones disponibles</td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</div>